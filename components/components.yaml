components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: |
        Access token obtained from Facebook OAuth 2.0.
        Required scopes: ads_management, ads_read, pages_read_engagement

  headers:
    BusinessUseCaseUsage:
      description: Usage stats for business use case
      schema:
        type: string
        example: "business_use_case=CAMPAIGNS_MANAGEMENT;points_used=10;points_remaining=8990"
    RateLimitReset:
      description: Time until rate limit reset in seconds
      schema:
        type: integer
        example: 300
    CacheControl:
      description: Cache control directives
      schema:
        type: string
        example: "public, max-age=300"
    RetryAfter:
      description: Time to wait before retrying in seconds
      schema:
        type: integer
        example: 60

  responses:
    BadRequest:
      description: Invalid request parameters
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/Error"
    Unauthorized:
      description: Invalid or expired access token
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/Error"
    RateLimitExceeded:
      description: Rate limit exceeded
      headers:
        Retry-After:
          $ref: "#/components/headers/RetryAfter"
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/Error"

  schemas:
    Error:
      type: object
      properties:
        error:
          type: object
          required:
            - message
            - type
            - code
          properties:
            message:
              type: string
              description: Error message
              example: "Invalid parameter"
            type:
              type: string
              description: Error type
              example: "OAuthException"
            code:
              type: integer
              description: Error code
              example: 100
            error_subcode:
              type: integer
              description: Error subcode
              example: 33
            fbtrace_id:
              type: string
              description: Facebook trace ID
              example: "XYZ123"

    Paging:
      type: object
      properties:
        cursors:
          type: object
          properties:
            before:
              type: string
              description: Cursor for previous page
            after:
              type: string
              description: Cursor for next page
        next:
          type: string
          description: URL for next page
        previous:
          type: string
          description: URL for previous page

    DatePreset:
      type: string
      enum:
        - today
        - yesterday
        - last_3d
        - last_7d
        - last_14d
        - last_28d
        - last_30d
        - last_90d
        - this_month
        - last_month
        - this_quarter
        - lifetime
      default: last_7d

    InsightLevel:
      type: string
      enum:
        - account
        - campaign
        - adset
        - ad
      default: account

    ActionType:
      type: string
      enum:
        - link_click
        - post_engagement
        - page_engagement
        - like
        - comment
        - post
        - post_reaction
        - post_save
        - video_view
        - landing_page_view
        - purchase
        - add_to_cart
        - initiate_checkout

    AdStatus:
      type: string
      enum:
        - ACTIVE
        - PAUSED
        - DELETED
        - ARCHIVED
      default: ACTIVE

    CampaignObjective:
      type: string
      enum:
        - LINK_CLICKS
        - POST_ENGAGEMENT
        - VIDEO_VIEWS
        - BRAND_AWARENESS
        - REACH
      default: LINK_CLICKS

    BidStrategy:
      type: string
      enum:
        - LOWEST_COST_WITHOUT_CAP
        - LOWEST_COST_WITH_BID_CAP
      default: LOWEST_COST_WITHOUT_CAP

    InsightMetrics:
      type: object
      properties:
        impressions:
          type: string
          description: Number of impressions
          example: "631"
        reach:
          type: string
          description: Number of people who saw the ads
          example: "589"
        spend:
          type: string
          description: Amount spent in account currency
          example: "15.95"
        ctr:
          type: string
          description: Click-through rate
          example: "6.66"
        cpc:
          type: string
          description: Cost per click
          example: "0.38"
        cpm:
          type: string
          description: Cost per 1000 impressions
          example: "25.28"
        frequency:
          type: string
          description: Average number of times each person saw the ad
          example: "1.07"

    ActionInsights:
      type: array
      description: Array of actions taken on the ad
      items:
        type: object
        properties:
          action_type:
            $ref: "#/components/schemas/ActionType"
          value:
            type: string
            description: Number of actions
            example: "250"
          action_target_id:
            type: string
            description: ID of action target
            example: "102264027940184"
          action_destination:
            type: string
            description: Where the action occurred
            example: "website"

    InsightsMetrics:
      type: object
      properties:
        impressions:
          type: integer
          description: Total de impressões
          example: 69488
        reach:
          type: integer
          description: Alcance único
          example: 33992
        spend:
          type: number
          description: Investimento em BRL
          example: 243.78
        ctr:
          type: number
          description: Taxa de cliques (%)
          example: 18.43
        cpc:
          type: number
          description: Custo por clique
          example: 0.10

    VideoMetrics:
      type: object
      properties:
        video_p25_watched_actions:
          type: integer
          description: Visualizações até 25%
          example: 800
        video_p50_watched_actions:
          type: integer
          description: Visualizações até 50%
          example: 600
        video_p75_watched_actions:
          type: integer
          description: Visualizações até 75%
          example: 400
        video_p95_watched_actions:
          type: integer
          description: Visualizações até 95%
          example: 200
        video_avg_time_watched_actions:
          type: number
          description: Tempo médio de visualização (segundos)
          example: 3.0

    FormatPerformance:
      type: object
      properties:
        stories:
          type: object
          description: Métricas de Stories
          properties:
            impressions:
              type: integer
              example: 13587
            reach:
              type: integer
              example: 11145
            spend:
              type: number
              example: 243.78
            cpm:
              type: number
              example: 17.94
            engagement_rate:
              type: number
              example: 18.43
            retention_50:
              type: number
              example: 57.8
            retention_95:
              type: number
              example: 24.1
            avg_watch_time:
              type: number
              example: 3.0
        reels:
          type: object
          description: Métricas de Reels
          properties:
            impressions:
              type: integer
              example: 3761
            reach:
              type: integer
              example: 3720
            spend:
              type: number
              example: 27.06
            cpm:
              type: number
              example: 7.20
            engagement_rate:
              type: number
              example: 31.16
            retention_50:
              type: number
              example: 43.1
            retention_95:
              type: number
              example: 18.3
            avg_watch_time:
              type: number
              example: 4.0

    CreativeInsights:
      type: object
      properties:
        data:
          type: array
          items:
            type: object
            properties:
              creative_id:
                type: string
              format:
                type: string
                enum: [story, reel, feed]
              metrics:
                type: object
                properties:
                  impressions:
                    type: integer
                    example: 69488
                  clicks:
                    type: integer
                    example: 2500
                  ctr:
                    type: number
                    example: 18.43
                  cpc:
                    type: number
                    example: 0.10
                  spend:
                    type: number
                    example: 243.78

    CostBenefitInsights:
      type: object
      properties:
        data:
          type: array
          items:
            type: object
            properties:
              date_start:
                type: string
                format: date
              date_end:
                type: string
                format: date
              spend:
                type: number
                example: 243.78
              conversions:
                type: integer
                example: 50
              cost_per_conversion:
                type: number
                example: 4.87
              conversion_rate:
                type: number
                example: 2.5

    InstagramInsights:
      type: object
      properties:
        data:
          type: array
          items:
            type: object
            properties:
              platform_position:
                type: string
                enum: [story, reel, feed]
              impressions:
                type: integer
                example: 69488
              reach:
                type: integer
                example: 33992
              engagement:
                type: object
                properties:
                  likes:
                    type: integer
                    example: 500
                  comments:
                    type: integer
                    example: 50
                  saves:
                    type: integer
                    example: 25
                  shares:
                    type: integer
                    example: 15

    GeographicInsights:
      type: object
      properties:
        data:
          type: array
          items:
            type: object
            properties:
              region:
                type: string
                example: "Rio de Janeiro"
              metrics:
                type: object
                properties:
                  impressions:
                    type: integer
                    example: 13587
                  reach:
                    type: integer
                    example: 11145
                  spend:
                    type: number
                    example: 243.78
                  clicks:
                    type: integer
                    example: 500
                  ctr:
                    type: number
                    example: 18.43
                  cpc:
                    type: number
                    example: 0.10

    AudienceInsights:
      type: object
      properties:
        age_gender:
          type: array
          items:
            type: object
            properties:
              age_range:
                type: string
                example: "25-34"
              gender:
                type: string
                enum: [1, 2]
                description: "1=mulheres, 2=homens"
              reach:
                type: integer
                example: 7831
              impressions:
                type: integer
                example: 9077
              engagement_rate:
                type: number
                example: 17.44
              cpe:
                type: number
                example: 0.06
        regions:
          type: array
          items:
            type: object
            properties:
              region:
                type: string
                example: "Rio de Janeiro"
              engagement_rate:
                type: number
                example: 27.23
              cpe:
                type: number
                example: 0.08

    Campaign:
      type: object
      required:
        - id
        - name
        - status
        - objective
      properties:
        id:
          type: string
          description: Campaign ID
          example: "23847392874"
        name:
          type: string
          description: Campaign name
          example: "Website Traffic Campaign"
        status:
          type: string
          description: Campaign status
          enum: [ACTIVE, PAUSED, DELETED]
          example: "ACTIVE"
        objective:
          type: string
          description: Campaign objective
          enum: [LINK_CLICKS, POST_ENGAGEMENT, VIDEO_VIEWS]
          example: "LINK_CLICKS"
        daily_budget:
          type: number
          description: Daily budget in account currency
          example: 100.00
        lifetime_budget:
          type: number
          description: Lifetime budget in account currency
          example: 1000.00

    AdSet:
      type: object
      required:
        - id
        - name
        - campaign_id
        - status
      properties:
        id:
          type: string
          description: Ad Set ID
          example: "23847392875"
        name:
          type: string
          description: Ad Set name
          example: "25-45 Interests"
        campaign_id:
          type: string
          description: Parent campaign ID
          example: "23847392874"
        status:
          type: string
          description: Ad Set status
          enum: [ACTIVE, PAUSED, DELETED]
          example: "ACTIVE"
        targeting:
          type: object
          properties:
            age_min:
              type: integer
              example: 25
            age_max:
              type: integer
              example: 45
            genders:
              type: array
              items:
                type: integer
                enum: [1, 2]
              description: "1=mulheres, 2=homens"
            geo_locations:
              type: object
              properties:
                countries:
                  type: array
                  items:
                    type: string
                    example: "BR"
                regions:
                  type: array
                  items:
                    type: string
                    example: "Rio de Janeiro"
            interests:
              type: array
              items:
                type: object
                properties:
                  id:
                    type: string
                    example: "6003349442621"
                  name:
                    type: string
                    example: "Fitness"

    InsightsResponse:
      type: object
      required:
        - data
      properties:
        data:
          type: array
          description: Lista de pontos de dados de insights
          items:
            type: object
            required:
              - date_start
              - date_end
            properties:
              date_start:
                type: string
                format: date
              date_end:
                type: string
                format: date
              metrics:
                $ref: "#/components/schemas/Campaign/properties/metrics"
              breakdowns:
                $ref: "#/components/schemas/Campaign/properties/breakdowns"
